---
permalink: sg5800/replace-battery-e4000.html 
sidebar: sidebar 
keywords:  
summary:  
---
= E4000のバッテリの交換（SG5800）
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
Grid Managerでストレージコントローラのバッテリ障害に関するアラートが発行された場合や、SANtricity System ManagerのRecovery Guruで「Battery Failed」または「Battery Replacement Required」ステータスが表示された場合は、E4000コントローラのバッテリを交換する必要があります。データを保護するには、できるだけ早くバッテリを交換する必要があります。

SANtricity System Manager の Recovery Guru で詳細を確認し、問題にバッテリが搭載されていること、および先に対処する必要がある項目がほかにないことを確認します。

.作業を開始する前に
障害が発生したバッテリを交換する場合は、次の準備をしておく必要があります。

* 交換用バッテリ。
* ESD リストバンドを装着するか、静電気防止処置を施しておきます。
* コントローラキャニスターに接続する各ケーブルを識別するためのラベル。
* SANtricityシステムマネージャへのアクセス：
+
** Grid Managerで、* nodes *>*_appliance node_*>* SANtricity System Manager *を選択します。コントローラ情報は https://docs.netapp.com/us-en/storagegrid-118/monitor/viewing-santricity-system-manager-tab.html["SANtricityの[System Manager]タブ"]。
** 管理ステーションのブラウザで、コントローラのドメイン名またはIPアドレスを指定します。






== 手順1：バッテリを交換する準備をする

障害が発生したバッテリを安全に取り外せるように、コントローラシェルフの電源をオフにします。

.手順
. SANtricity System Managerを使用してストレージアレイの構成データベースをバックアップします。
+
コントローラを取り外すときに問題が発生した場合は、保存したファイルを使用して構成をリストアできます。RAID 構成データベースの現在の状態が保存されます。これには、コントローラ上のボリュームグループとディスクプールのすべてのデータが含まれます。

+
** System Manager から：
+
... *サポート›サポートセンター›診断*を選択します。
... [ 構成データの収集 *] を選択します。
... [*Collect*]( 収集 ) をクリックします
+
ブラウザの Downloads フォルダに、「 * configurationdata-<ArrayName>-<dateTime >.7z * 」という名前でファイルが保存されます。



** または、次の CLI コマンドを使用して構成データベースをバックアップすることもできます。
+
`save storageArray dbmDatabase sourceLocation=onboard contentType=all file="filename";`



. SANtricity システムマネージャを使用してストレージアレイのサポートデータを収集します。
+
コントローラの取り外し時に問題が発生した場合は、保存したファイルを使用して問題のトラブルシューティングを行うことができます。ストレージアレイに関するインベントリ、ステータス、およびパフォーマンスデータが 1 つのファイルに保存されます。

+
.. *サポート›サポートセンター›診断*を選択します。
.. 「サポートデータの収集」を選択します。
.. [*Collect*]( 収集 ) をクリックします
+
ブラウザの Downloads フォルダに、「 * support-data.7z * 」という名前でファイルが保存されます。



. SG5800コントローラをシャットダウンします。
+
.. グリッドノードにログインします。
+
... 次のコマンドを入力します。 `ssh admin@grid_node_IP`
... に記載されているパスワードを入力します `Passwords.txt` ファイル。
... 次のコマンドを入力してrootに切り替えます。 `su -`
... に記載されているパスワードを入力します `Passwords.txt` ファイル。
+
rootとしてログインすると、プロンプトがから変わります `$` 終了： `#`。



.. SG5800コントローラをシャットダウンします。
+
*`shutdown -h now`*

.. キャッシュメモリ内のデータがドライブに書き込まれるまで待ちます。
+
キャッシュされたデータをドライブに書き込む必要がある場合は、E4000コントローラの背面にある緑のキャッシュアクティブLEDが点灯します。この LED が消灯するまで待つ必要があります。



. SANtricity システムマネージャのホームページで、「 * 進行中の処理を表示」を選択します。
. すべての処理が完了したことを確認してから、次の手順に進みます。
. コントローラシェルフの両方の電源スイッチをオフにします。
. コントローラシェルフのすべての LED が消灯するまで待ちます。




== 手順2：E4000コントローラキャニスターを取り外す

バッテリを取り外すためには、コントローラキャニスターをコントローラシェルフから取り外す必要があります。

.作業を開始する前に
次のものがあることを確認します。

* ESD リストバンドを装着するか、静電気防止処置を施しておきます。
* コントローラキャニスターに接続する各ケーブルを識別するためのラベル。


.手順
. コントローラキャニスターからすべてのケーブルを外します。
+

CAUTION: パフォーマンスの低下を防ぐために、ケーブルをねじったり、折り曲げたり、はさんだり、踏みつけたりしないでください。

. コントローラキャニスターのホストポートで SFP+ トランシーバを使用している場合は、取り付けたままにしておきます。
. コントローラの背面にあるキャッシュアクティブ LED が消灯していることを確認します。
. カムハンドルのラッチを外れるまで押し、カムハンドルをいっぱいまで開いてコントローラキャニスターをミッドプレーンから外し、両手でコントローラキャニスターをシャーシから半分引き出します。




== 手順3：新しいバッテリを取り付ける

障害が発生したバッテリを取り外して交換する必要があります。

.手順
. 新しいバッテリを開封し、静電気防止処置を施した平らな場所に置きます。
+

NOTE: IATA 安全規則に準拠するため、交換用バッテリは 30% 以下の充電状態（ SoC ）で出荷されます。交換用バッテリに電源を再投入したあと、フル充電されて最初の学習サイクルが完了するまでは、書き込みキャッシュが再開されないことに注意してください。

. 接地対策がまだの場合は、自身で適切に実施します。
. コントローラキャニスターをシャーシから取り外します。
. コントローラキャニスターを裏返し、平らで安定した場所に置きます。
. コントローラキャニスターの側面にある青いボタンを押してカバーを開き、カバーを上に回転させてコントローラキャニスターから取り外します。
+
image::../media/drw_E4000_open_controller_module_cover_IEOPS-870.png[コントローラモジュールのカバーを開きます。]

. コントローラキャニスターでバッテリの場所を確認します。
. 障害が発生したバッテリをコントローラキャニスターから取り外します。
+
.. コントローラキャニスターの側面にある青いボタンを押します。
.. 保持ブラケットからバッテリを上にスライドさせ、持ち上げてコントローラキャニスターから取り出します。
.. コントローラキャニスターからバッテリを抜きます。
+
image::../media/drw_E4000_replace_nvbattery_IEOPS-862.png[NVMEMバッテリを取り外します。]

+
|===


 a| 
image::../media/legend_icon_01.png[凡例アイコン01]
| バッテリリリースタブ 


 a| 
image::../media/legend_icon_02.png[凡例アイコン 02]
| バッテリ電源コネクタ 
|===


. 交換用バッテリをパッケージから取り出します。交換用バッテリを取り付けます。
+
.. バッテリプラグをコントローラキャニスターのソケットに再度接続します。
+
プラグがマザーボードのバッテリソケットに固定されていることを確認します。

.. バッテリを金属板の側壁の保持ブラケットに合わせます。
.. バッテリラッチがカチッという音がして側壁の開口部に収まるまで、バッテリパックを下にスライドさせます。


. コントローラキャニスターのカバーを再度取り付け、所定の位置にロックします。




== 手順 4 ：コントローラキャニスターを再度取り付けます

コントローラキャニスターのコンポーネントを交換したら、シャーシに再度取り付けます。

.手順
. 接地対策がまだの場合は、自身で適切に実施します。
. コントローラキャニスターのカバーを取り付けます（まだ取り付けていない場合）。
. コントローラキャニスターを裏返し、端をシャーシの開口部に合わせます。
. コントローラキャニスターの端をシャーシの開口部に合わせ、コントローラキャニスターをシステムの半分までそっと押し込みます。
+

NOTE: 指示があるまでコントローラキャニスターをシャーシに完全に挿入しないでください。

. 必要に応じてシステムにケーブルを再接続します。
. コントローラキャニスターの再取り付けが完了します。
+
.. カムハンドルを開いた状態で、コントローラキャニスターをミッドプレーンまでしっかりと押し込んで完全に装着し、カムハンドルをロック位置まで閉じます。
+

NOTE: コネクタの破損を防ぐため、コントローラキャニスターをスライドしてシャーシに挿入する際に力を入れすぎないように注意してください。

+
コントローラは、シャーシに装着されるとすぐにブートを開始します。

.. ケーブルマネジメントデバイスをまだ取り付けていない場合は、取り付け直します。
.. ケーブルマネジメントデバイスに接続されているケーブルをフックとループストラップでまとめます。






== 手順5：バッテリ交換後の処理

コントローラの電源をオンにします。

.手順
. コントローラシェルフの背面にある 2 つの電源スイッチをオンにします。
+
** 電源投入プロセスの実行中は電源スイッチをオフにしないでください。通常、このプロセスは 90 秒以内に完了します。
** 各シェルフのファンは起動時に大きな音を立てます。起動時に大きな音がしても問題はありません。


. コントローラがオンラインに戻ったら、コントローラシェルフの警告LEDを確認します。
+
ステータスが「最適」でない場合やいずれかの警告 LED が点灯している場合は、すべてのケーブルが正しく装着され、バッテリとコントローラキャニスターが正しく取り付けられていることを確認します。必要に応じて、コントローラキャニスターとバッテリを取り外して再度取り付けます。

+

NOTE: 問題が解決しない場合は、テクニカルサポートにお問い合わせください。
必要に応じて、 SANtricity System Manager を使用してストレージアレイのサポートデータを収集します。

. SANtricity システムマネージャを使用してストレージアレイのサポートデータを収集します。
+
.. *サポート›サポートセンター›診断*を選択します。
.. [サポートデータの収集]を選択します。
.. 収集をクリックします。
+
ブラウザの Downloads フォルダに、「 * support-data.7z * 」という名前でファイルが保存されます。



. リブートが完了し、ノードが再びグリッドに参加したことを確認します。Grid Managerで、アプライアンスノードの*[Nodes]*ページで、アクティブなアラートがなく、ノードがグリッドに接続されていることを示す正常なステータス（ノード名の左側にある緑のチェックマーク）が表示されていることを確認します。
+

NOTE: 電源スイッチをオンにしてから、ノードがグリッドに再び参加してGrid Managerに正常ステータスが表示されるまで、20分かかることがあります。」



.次の手順
これでバッテリの交換は完了です。通常の運用を再開することができます。
