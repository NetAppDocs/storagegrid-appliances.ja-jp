---
permalink: commonhardware/checking-dns-server-configuration.html 
sidebar: sidebar 
keywords: DNS, server, servers, check, checking, change, changing, modify, modifying, modification 
summary: このアプライアンスノードで現在使用されているDNSサーバを確認し、一時的に変更することができます。 
---
= DNS サーバの設定を確認します
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
このアプライアンスノードで現在使用されているDNSサーバを確認し、一時的に変更することができます。

.作業を開始する前に
アプライアンスは次のようになりました link:../commonhardware/placing-appliance-into-maintenance-mode.html["メンテナンスモードにしました"]。

.このタスクについて
暗号化されたアプライアンスがキー管理サーバ（KMS）またはKMSクラスタに接続できない場合は、DNSサーバ設定の変更が必要になることがあります。これは、KMSのホスト名がIPアドレスではなくドメイン名として指定されているためです。アプライアンスの DNS 設定に加えた変更は一時的なものであり、メンテナンスモードを終了すると失われます。これらの変更を永続的に行うには、 Grid Manager で DNS サーバを指定します（ * maintenance * > * Network * > * DNS servers * ）。

* DNS 設定の一時的な変更が必要になるのは、ホスト名に IP アドレスではなく完全修飾ドメイン名を使用して KMS サーバが定義されているノード暗号化アプライアンスのみです。
* ノード暗号化アプライアンスをドメイン名を使用して KMS に接続する場合は、グリッド用に定義されている DNS サーバの 1 つに接続する必要があります。これらの DNS サーバの 1 つが、ドメイン名を IP アドレスに変換します。
* ノードがグリッドのDNSサーバにアクセスできない場合や、ノード暗号化アプライアンスノードがオフラインのときにグリッド全体のDNS設定を変更した場合、そのノードはKMSに接続できません。アプライアンス上の暗号化されたデータは、DNS問題 が解決されるまで復号化できません。


KMS 接続を回避する DNS 問題 を解決するには、 StorageGRID アプライアンスインストーラで 1 つ以上の DNS サーバの IP アドレスを指定します。この一時的な DNS 設定により、アプライアンスは KMS に接続してノード上のデータを復号化することができます。

たとえば、暗号化されたノードがオフラインのときにグリッドのDNSサーバが変更された場合、そのノードは以前のDNS値を使用しているため、オンラインに戻ってもKMSにアクセスできません。StorageGRID アプライアンスインストーラで新しい DNS サーバの IP アドレスを入力すると、 KMS 接続を使用してノードのデータを復号化できます。

.手順
. StorageGRID アプライアンスインストーラから、 *Configure Networking *>*DNS Configuration* を選択します。
. 指定した DNS サーバが正しいことを確認してください。
+
image::../media/dns_configuration.png[DNS設定]

. 必要に応じて、 DNS サーバを変更します。
+

NOTE: DNS 設定に対する変更は一時的なものであり、メンテナンスモードを終了すると失われます。

. 一時的な DNS 設定に問題がなければ、 * 保存 * を選択します。
+
ノードは、このページで指定されている DNS サーバ設定を使用して KMS に再接続し、ノード上のデータを復号化できるようにします。

. ノードデータが復号化されたら、ノードをリブートします。StorageGRID アプライアンス・インストーラから、 *Advanced*>*Reboot Controller* を選択し、次のいずれかのオプションを選択します。
+
** Reboot into StorageGRID * を選択し、ノードをグリッドに再追加してコントローラをリブートします。メンテナンスモードで作業を完了し、ノードを通常動作に戻す準備ができている場合は、このオプションを選択します。
** メンテナンスモードを維持したままコントローラをリブートするには、 * Reboot into Maintenance Mode * を選択します。（このオプションは、コントローラがメンテナンスモードのときにのみ使用できます）。 このオプションは、グリッドに再追加する前にノードで追加のメンテナンス処理を実行する必要がある場合に選択します。
+
image::../media/reboot_controller_from_maintenance_mode.png[コントローラをメンテナンスモードでリブートします]

+

NOTE: ノードがリブートしてグリッドに再び参加すると、 Grid Manager にリストされているシステム全体の DNS サーバが使用されます。グリッドに再追加したあとは、アプライアンスがメンテナンスモードのときに、 StorageGRID アプライアンスインストーラで指定された一時的な DNS サーバがアプライアンスで使用されなくなります。

+
アプライアンスがリブートしてグリッドに再参加するまでに最大 20 分かかることがあります。リブートが完了し、ノードが再びグリッドに参加したことを確認するには、 Grid Manager に戻ります。nodes *ページに、アプライアンスノードの正常なステータス（ノード名の左側にある緑のチェックマークアイコン）が表示され、アクティブなアラートがなく、ノードがグリッドに接続されていることが示されますimage:../media/icon_alert_green_checkmark.png["緑のチェックマーク"]。

+
image::../media/nodes_menu.png[アプライアンスノードがグリッドに再参加しました]




